var Pipeline, underscore;
var __slice = Array.prototype.slice;
underscore = require('underscore');
module.exports = Pipeline = (function() {
  var empty, method, _i, _j, _len, _len2, _ref, _ref2;
  empty = [];
  _ref = 'forEach,indexOf,join,pop,reverse,shift,sort,splice,unshift,push'.split(',');
  for (_i = 0, _len = _ref.length; _i < _len; _i++) {
    method = _ref[_i];
    Pipeline.prototype[method] = empty[method];
  }
  _ref2 = ('first,initial,last,rest,compact,flatten,without,union,' + 'intersection,difference,uniq,zip,lastIndexOf,range').split(',');
  for (_j = 0, _len2 = _ref2.length; _j < _len2; _j++) {
    method = _ref2[_j];
    Pipeline.prototype[method] = (function(method) {
      return function() {
        return underscore[method].apply(underscore, [this].concat(__slice.call(arguments)));
      };
    })(method);
  }
  function Pipeline(pipeline, queue, callback) {
    this.queue = queue;
    this.length = 0;
    if (pipeline.length) {
      this.push.apply(this, [].slice.call(pipeline));
    }
    Object.defineProperty(this, 'callback', {
      value: callback
    });
  }
  return Pipeline;
})();